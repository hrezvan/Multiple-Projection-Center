function [EOP,ACC,dr,dc] = resection(str,f,PTS1,PTS2)
Sx = 0.000013;
Nr = 6000;
r = PTS1(:,2);
c = PTS1(:,1);

X = PTS1(:,3);
Y = PTS1(:,4);
Z = PTS1(:,5);
x = (r-(Nr/2))*Sx;
y = (c-(Nr/2))*Sx;
t=r;

EOP = zeros(18,1);
A1 = [x y ones(size(x)) zeros(size(x));y -x zeros(size(x)) ones(size(x))];
B1 = [X;Y];
parameter = inv(A1'*A1)*A1'*B1;
EOP(1) = parameter(3);
EOP(4) = parameter(4);
EOP(7) = sqrt(parameter(2)^2+parameter(1)^2)*f;
EOP(16) = atan(parameter(2)/parameter(1));

X = PTS1(:,3);
Y = PTS1(:,4);
Z = PTS1(:,5);
dEOP(:,1) = ones(9,1);
while norm(dEOP) >= 1e-3
   X0 = EOP(1);X1 = EOP(2);X2 = EOP(3); 
   Y0 = EOP(4);Y1 = EOP(5);Y2 = EOP(6); 
   Z0 = EOP(7);Z1 = EOP(8);Z2 = EOP(9); 
   w0 = EOP(10);w1 = EOP(11);w2 = EOP(12); 
   p0 = EOP(13);p1 = EOP(14);p2 = EOP(15); 
   k0 = EOP(16);k1 = EOP(17);k2 = EOP(18);
   
   B = [(f.*cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) - (f.*sin(p2.*t.^2 + p1.*t + p0).*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2,   (f.*t.*cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) - (f.*t.*sin(p2.*t.^2 + p1.*t + p0).*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2,   (f.*t.^2.*cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) - (f.*t.^2.*sin(p2.*t.^2 + p1.*t + p0).*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, (f.*(cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) + (f.*cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, (f.*t.*(cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) + (f.*t.*cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, (f.*t.^2.*(cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) + (f.*t.^2.*cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, (f.*(sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) - (f.*cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, (f.*t.*(sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) - (f.*t.*cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, (f.*t.^2.*(sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) - (f.*t.^2.*cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, (f.*(cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Y2.*t.^2 + Y1.*t - Y + Y0)).*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2 - (f.*((sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) - (cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)), (f.*(t.*cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + t.*cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2 - (f.*((t.*sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - t.*cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) - (t.*cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + t.*cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)), (f.*((t.^2.*cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + t.^2.*cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - (t.^2.*sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - t.^2.*cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) + (f.*(t.^2.*cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + t.^2.*cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, - (f.*(cos(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) + cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) - (f.*(cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0) + sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0).*(Y2.*t.^2 + Y1.*t - Y + Y0)).*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, - (f.*(t.*cos(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) + t.*cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0) - t.*cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) - (f.*(t.*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - t.*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0) + t.*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0).*(Y2.*t.^2 + Y1.*t - Y + Y0)).*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, - (f.*(t.^2.*cos(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) + t.^2.*cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0) - t.^2.*cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) - (f.*(t.^2.*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - t.^2.*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0) + t.^2.*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0).*(Y2.*t.^2 + Y1.*t - Y + Y0)).*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2,  (f.*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)),  (f.*((t.*cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - t.*sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (t.*cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + t.*cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - t.*cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)),  (f.*((t.^2.*cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + t.^2.*cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + (t.^2.*cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - t.^2.*sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) - t.^2.*cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0));
                  -(f.*cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) - (f.*sin(p2.*t.^2 + p1.*t + p0).*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, - (f.*t.*sin(p2.*t.^2 + p1.*t + p0).*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2 - (f.*t.*cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)), - (f.*t.^2.*cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) - (f.*t.^2.*sin(p2.*t.^2 + p1.*t + p0).*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, (f.*(cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) + (f.*cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, (f.*t.*(cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) + (f.*t.*cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, (f.*t.^2.*(cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) + (f.*t.^2.*cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, (f.*(cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) - (f.*cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, (f.*t.*(cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) - (f.*t.*cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, (f.*t.^2.*(cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) - (f.*t.^2.*cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, (f.*(cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Y2.*t.^2 + Y1.*t - Y + Y0)).*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2 - (f.*((cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) - (cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)), (f.*(t.*cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + t.*cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2 - (f.*((t.*cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + t.*cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) - (t.*cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - t.*sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)), (f.*((t.^2.*cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - t.^2.*sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - (t.^2.*cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + t.^2.*cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) + (f.*(t.^2.*cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + t.^2.*cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2,   (f.*(sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) - (f.*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)).*(cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0) + sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0).*(Y2.*t.^2 + Y1.*t - Y + Y0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2,   (f.*(t.*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) + t.*cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(Z2.*t.^2 + Z1.*t - Z + Z0) - t.*cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) - (f.*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)).*(t.*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - t.*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0) + t.*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0).*(Y2.*t.^2 + Y1.*t - Y + Y0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2,   (f.*(t.^2.*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) + t.^2.*cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(Z2.*t.^2 + Z1.*t - Z + Z0) - t.^2.*cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)) - (f.*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)).*(t.^2.*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - t.^2.*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0) + t.^2.*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0).*(Y2.*t.^2 + Y1.*t - Y + Y0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)).^2, -(f.*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)), -(f.*((t.*cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + t.*cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (t.*sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - t.*cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + t.*cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)), -(f.*((t.^2.*sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - t.^2.*cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + (t.^2.*cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + t.^2.*cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + t.^2.*cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0))];
   B(:,str==0) = [];

    Fx =-(f.*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0));
    Fy = -y - (f.*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0));
   
    F = [Fx;Fy];
    dEOP = B\F;
%     dEOP = inv(B'*B)*B'*F;
    EOP(str==1) = EOP(str==1) + dEOP;
end

r = PTS2(:,2);
c = PTS2(:,1);
x = (r-(Nr/2)).*Sx;
t = r;
y = (c-(Nr/2)).*Sx;
X = PTS2(:,3);
Y = PTS2(:,4);
Z = PTS2(:,5);

xx = -(f.*((cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0) + cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) - cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) + cos(k2.*t.^2 + k1.*t + k0).*cos(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0));
yy = -((f.*((cos(k2.*t.^2 + k1.*t + k0).*cos(w2.*t.^2 + w1.*t + w0) - sin(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0).*sin(p2.*t.^2 + p1.*t + p0)).*(Y2.*t.^2 + Y1.*t - Y + Y0) + (cos(k2.*t.^2 + k1.*t + k0).*sin(w2.*t.^2 + w1.*t + w0) + cos(w2.*t.^2 + w1.*t + w0).*sin(k2.*t.^2 + k1.*t + k0).*sin(p2.*t.^2 + p1.*t + p0)).*(Z2.*t.^2 + Z1.*t - Z + Z0) - cos(p2.*t.^2 + p1.*t + p0).*sin(k2.*t.^2 + k1.*t + k0).*(X2.*t.^2 + X1.*t - X + X0)))./(sin(p2.*t.^2 + p1.*t + p0).*(X2.*t.^2 + X1.*t - X + X0) - cos(p2.*t.^2 + p1.*t + p0).*sin(w2.*t.^2 + w1.*t + w0).*(Y2.*t.^2 + Y1.*t - Y + Y0) + cos(w2.*t.^2 + w1.*t + w0).*cos(p2.*t.^2 + p1.*t + p0).*(Z2.*t.^2 + Z1.*t - Z + Z0)));

dc=xx;
dr=yy-y;
ACC(1,1)=sqrt((dc'*dc/length(dc)));
ACC(1,2)=sqrt((dr'*dr/length(dr)));
end